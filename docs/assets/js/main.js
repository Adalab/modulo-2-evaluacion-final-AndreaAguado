"use strict";const input=document.querySelector(".js_input"),list=document.querySelector(".js_list"),favList=document.querySelector(".js_favs_list"),button=document.querySelector(".js_submit_button");let resetButton,deleteButton,url;function urlMaker(){return url="//api.tvmaze.com/search/shows?q=",url+=input.value,url}let listItem,shows=[];function requestToAPI(){shows=[],url=urlMaker(),fetch(url).then(t=>t.json()).then(t=>{for(let e=0;e<t.length;e++)shows[e]=t[e].show;displayNoResults()})}function displayResults(){let t="";for(let e=0;e<shows.length;e++){t+=isFavorite(shows[e])?`<li class="list_item js_list_item fav" id="${shows[e].id}">`:`<li class="list_item js_list_item" id="${shows[e].id}">`,t+='<div class="container">',null===shows[e].image?t+='<img class="img" src="https://via.placeholder.com/210x295/b5a899/736762/?text=TV" alt="movie cover">':t+=`<img class="img" src=${shows[e].image.medium} alt="movie cover">`,t+=`  <h2 class="movie_title">${shows[e].name}</h2>`,t+="</div>",t+="</li>"}list.innerHTML=t,listenFavs()}function listenFavs(){listItem=document.querySelectorAll(".js_list_item");for(const t of listItem)t.addEventListener("click",handleListItems)}function displayNoResults(){if(shows.length<1){const t=document.createElement("p");t.classList.add("message");const e=document.createTextNode(`No se encontraron resultados para "${input.value}"`);t.appendChild(e),list.appendChild(t)}else displayResults()}let favorites=[];function isFavorite(t){return void 0!==favorites.find(e=>e.id===t.id)}function handleListItems(t){const e=t.currentTarget.id;t.currentTarget.classList.toggle("fav");const s=shows.find(t=>t.id===parseInt(e)),o=favorites.findIndex(t=>t.id===parseInt(e));-1===o?favorites.push(s):favorites.splice(o,1),displayFavsList(),saveToLocalStorage()}function saveToLocalStorage(){localStorage.setItem("favorites",JSON.stringify(favorites))}function getFromLocalStorage(){let t=JSON.parse(localStorage.getItem("favorites"));if(null===t){const t=document.createElement("li");t.classList.add("fav_item");const e=document.createTextNode("Aun no tienes favoritos.");t.appendChild(e),favList.appendChild(t)}else favorites=t,displayFavsList()}function displayFavsList(){let t="";if(0===favorites.length||null===favorites)t+="Aun no tienes favoritos.";else{for(const e of favorites)t+=`<li class="fav_item js_fav_item" id="${e.id}">`,null===e.image?(t+='<div class="fav_item_info">',t+='<img class="img" src="https://via.placeholder.com/210x295/b5a899/736762/?text=TV"  alt="movie cover">'):(t+='<div class="fav_item_info">',t+=`<img class="img" src="${e.image.medium}" alt="movie cover">`),t+=`<h2 class="movie_title">${e.name}</h2>`,t+="</div>",t+=`<button class="reset_button js_reset_button" id="${e.id}">X</button>`,t+="</li>";t+='<button class="delete_button js_delete_button">Borrar todos</button>'}favList.innerHTML=t,listenResetButtons(),listenDeleteButton()}function listenResetButtons(){resetButton=document.querySelectorAll(".js_reset_button");for(const t of resetButton)t.addEventListener("click",handleResetButton)}function handleResetButton(t){t.preventDefault();const e=t.currentTarget.id,s=favorites.findIndex(t=>t.id===parseInt(e));favorites.splice(s,1),displayFavsList(),saveToLocalStorage()}function listenDeleteButton(){deleteButton=document.querySelector(".js_delete_button"),deleteButton.addEventListener("click",handleDeleteButton)}function handleDeleteButton(t){t.preventDefault(),favorites=[],removeFromLocalStorage(),displayFavsList()}function removeFromLocalStorage(){localStorage.removeItem("favorites")}function handleButton(t){t.preventDefault(),requestToAPI()}getFromLocalStorage(),button.addEventListener("click",handleButton);